// js for counter up

(function ($) {
    "use strict";
    $.fn.counterUp = function (options) {
        var settings = $.extend({
            time: 400,
            delay: 10
        }, options);

        return this.each(function () {
            var $this = $(this),
                originalText = $this.text(),
                targetValue = parseInt(originalText.replace(/\D/g, ''), 10);

            $this.data("counterup-nums", generateCounterArray(targetValue));
            $this.text("0");

            var counterFunction = function () {
                $this.text($this.data("counterup-nums").shift() + "+");
                if ($this.data("counterup-nums").length) {
                    setTimeout($this.data("counterup-func"), settings.delay);
                } else {
                    delete $this.data("counterup-nums");
                    $this.data("counterup-nums", null);
                    $this.data("counterup-func", null);
                }
            };

            $this.data("counterup-func", counterFunction);
            setTimeout($this.data("counterup-func"), settings.delay);

            function generateCounterArray(target) {
                var counterArray = [],
                    steps = settings.time / settings.delay;

                for (var i = steps; i >= 1; i--) {
                    var stepValue = Math.floor(target / steps * i);
                    counterArray.unshift(stepValue);
                }

                return counterArray;
            }
        });
    };
})(jQuery);

$('.counter').counterUp({
    delay: 20,
    time: 2000
});
